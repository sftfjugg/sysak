---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liaozhaoyan.
--- DateTime: 2022/12/8 10:37 AM
---

local pystring = {}

local function formatKey(key)
    local t = type(key)
    if t == "number" then
        return "["..key.."]"
    elseif t == "string" then
        local n = tonumber(key)
        if n then
            return "["..key.."]"
        end
    end
    return key
end

local function newStack()
    local stack = {
        tableList = {}
    }
    function stack:push(t)
        table.insert(self.tableList, t)
    end
    function stack:pop()
        return table.remove(self.tableList)
    end
    function stack:contains(t)
        for _, v in ipairs(self.tableList) do
            if v == t then
                return true
            end
        end
        return false
    end
    return stack
end

local function checkDelimiter(ch)
    local s = "().%+-*?[]^$"
    if ch == " " then
        return "%s"
    end
    for c in string.gmatch(s, ".") do
        if c == ch then
            return "%" .. ch
        end
    end
    return ch
end

local function setupDelimiter(delimiter)
    local rt = {}
    local i = 0
    for c in string.gmatch(delimiter, ".") do
        i = i + 1
        rt[i] = checkDelimiter(c)
    end
    return table.concat(rt)
end

local function setupPatten(s)
    local patten
    if s == nil then
        patten = "[%s\t\n]"
    else
        patten = setupDelimiter(s)
    end
    return patten
end

function pystring:shift(s, n)  -- position for right, negative for left
    local len = string.len(s)
    if len == 0 then
        return s
    end
    n = n % len
    if n == 0 then
        return s
    elseif n > 0 then  -- "abcd >> 1"
        local offset = len - n
        local s1 = string.sub(s, offset + 1)
        local s2 = string.sub(s, 1, offset)
        return s1 .. s2
    else   -- "abcd << 1"
        local offset = len + n
        local s1 = string.sub(s, offset + 1)
        local s2 = string.sub(s, 1, offset)
        return s2 .. s1
    end
end

function pystring:lower(s)
    return string.lower(s)
end

function pystring:upper(s)
    return string.upper(s)
end

function pystring:swapcase(s)
    local swaps = {}
    for i=1, #s do
        local ch = string.byte(s, i)
        if ch >= 65 and ch <= 90 then
            swaps[i] = string.char(ch + 32)
        elseif ch >= 97 and ch <= 122 then
            swaps[i] = string.char(ch - 32)
        else
            swaps[i] = string.char(ch)
        end
    end
    return table.concat(swaps)
end

function pystring:capitalize(s)
    if #s < 1 then
        return s
    end
    local s1 = string.sub(s, 1, 1)
    local s2 = string.sub(s, 2)
    return string.upper(s1) .. s2
end

function pystring:capwords(s)
    local lines = pystring:split(s, "\n")
    local rLines = {}
    for i, line in ipairs(lines) do
        local rWords = {}
        local words = pystring:split(line, " ")
        for j, word in ipairs(words) do
            rWords[j] = pystring:capitalize(word)
        end
        rLines[i] = table.concat(rWords, " ")
    end
    return table.concat(rLines, "\n")
end

function pystring:split(s, delimiter, n)
    local result = {}
    if not delimiter or delimiter == "" then  -- for blank, gsub multi blank to single
        s = string.gsub(s, "%s+", " ")
    end
    local delimiter = setupDelimiter(delimiter or " ")
    local n = n or 2 ^ 63 - 1

    local nums = 0
    local beg = 1
    local c = 0
    while (true) do
        local iBeg, iEnd = string.find(s, delimiter, beg)
        if (iBeg) then
            c = c + 1
            result[c] = string.sub(s, beg, iBeg - 1)
            beg = iEnd + 1
            nums = nums + 1
            if nums >= n then
                c = c + 1
                result[c] = string.sub(s, beg, string.len(s))
                break
            end
        else
            c = c + 1
            result[c] = string.sub(s, beg, string.len(s))
            break
        end
    end
    return result
end

function pystring:reverseTable(t)
    local n = #t
    for i = 1, n / 2 do
        t[i], t[n + 1 - i] = t[n + 1 - i], t[i]
    end
end

function pystring:rsplit(s, delimiter, n)
    local result = {}
    local n = n or 2 ^ 63 - 1
    local len = string.len(s) + 1
    local rs = string.reverse(s)
    local rDel = string.reverse(delimiter or " ")
    rDel = setupDelimiter(rDel)
    local nums = 0
    local beg = 1
    local c = 0

    while (true) do
        local iBeg, iEnd = string.find(rs, rDel, beg)
        if (iBeg) then
            c = c + 1
            result[c] = string.sub(s, len - (iBeg - 1),len - beg)
            beg = iEnd + 1
            nums = nums + 1
            if nums >= n then
                c = c + 1
                result[c] = string.sub(s, 1, len - beg)
                break
            end
        else
            c = c + 1
            result[c] = string.sub(s, 1, len - beg)
            break
        end
    end
    --return result
    pystring:reverseTable(result)
    return result
end

function pystring:lstrip(s, chars)
    local patten = "^" .. setupPatten(chars) .. "+"
    local _, ends = string.find(s, patten)
    if ends then
        return string.sub(s, ends + 1, -1)
    else
        return s
    end
end

function pystring:rstrip(s, chars)
    local patten = setupPatten(chars) .. "+$"
    local last = string.find(s, patten)
    if last then
        return string.sub(s, 1, last - 1)
    else
        return s
    end
end

function pystring:strip(s, chars)
    local res = pystring:lstrip(s, chars)
    return pystring:rstrip(res, chars)
end

function pystring:join(delim, strings)
    return table.concat(strings, delim)
end

function pystring:startswith(s1, s2)
    return string.sub(s1,1,string.len(s2)) == s2
end

function pystring:endswith(s1, s2)
    return s2=='' or string.sub(s1,-string.len(s2)) == s2
end

function pystring:find(s1, s2)
    return string.find(s1, s2, 1, false)
end

return pystring
